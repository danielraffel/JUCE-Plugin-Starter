# Repository Integration Plan

## Overview

This document outlines the plan to integrate the enhanced build system and tooling from the `integrate/` folder into the main JUCE-Plugin-Starter repository. The integration includes:

1. **Enhanced Build System**: New unified build script with comprehensive functionality
2. **Version Management**: Python-based semantic versioning system
3. **Additional Tooling**: Diagnostic, validation, and release note generation scripts
4. **Updated Configuration**: Enhanced CMakeLists.txt and generate_and_open_xcode.sh
5. **Documentation Updates**: Updated CLAUDE.md and new build system documentation

## Phase 1: Pre-Integration Preparation

### 1.1 Copy .env.example File
**Status**: READY - Found in integrate folder
**Action**: Copy the comprehensive .env.example from integrate/ to root directory

**The file includes**:
- Developer settings (DEVELOPER_NAME, MANUFACTURER_CODE, etc.)
- Apple Developer configuration (APPLE_ID, TEAM_ID, certificates)
- Project configuration (auto-generated by init_plugin_project.sh)
- Version management (semantic versioning support)
- Build system configuration
- GitHub release settings
- AI-powered release notes configuration
- Extensive documentation and organization

### 1.2 Backup Current Files
**Action**: Document which files will be replaced/updated
- `CMakeLists.txt` - Will be replaced
- `generate_and_open_xcode.sh` - Will be replaced
- `init_plugin_project.sh` - Will be replaced
- `CLAUDE.md` - Will be replaced
- `scripts/post_build.sh` - Will be replaced

## Phase 2: Core File Integration

### 2.1 Replace Root Level Files
**Priority**: High
**Risk**: Medium

**Files to replace**:
1. `CMakeLists.txt` → `integrate/CMakeLists.txt`
2. `generate_and_open_xcode.sh` → `integrate/generate_and_open_xcode.sh`
3. `init_plugin_project.sh` → `integrate/init_plugin_project.sh`
4. `CLAUDE.md` → `integrate/CLAUDE.md`

**Validation steps**:
- Ensure all files are executable after replacement
- Verify CMakeLists.txt references are consistent
- Check that init_plugin_project.sh references correct script locations

### 2.2 Update Scripts Directory
**Priority**: High
**Risk**: Medium

**Actions**:
1. Replace `scripts/post_build.sh` with `integrate/scripts/post_build.sh`
2. Add new scripts:
   - `scripts/build.sh` (from `integrate/scripts/build.sh`)
   - `scripts/bump_version.py` (from `integrate/scripts/bump_version.py`)
   - `scripts/diagnose_plugin.sh` (from `integrate/scripts/diagnose_plugin.sh`)
   - `scripts/generate_release_notes.py` (from `integrate/scripts/generate_release_notes.py`)
   - `scripts/validate_plugin.sh` (from `integrate/scripts/validate_plugin.sh`)
3. Remove obsolete `scripts/sign_and_package_plugin.sh` (replaced by new build system)

**Validation steps**:
- Make all new scripts executable
- Test that Python scripts have correct shebang and dependencies
- Verify script cross-references are correct

## Phase 3: Documentation Integration

### 3.1 Add New Documentation
**Priority**: Medium
**Risk**: Low

**Actions**:
1. Create `scripts/about/` directory
2. Add `scripts/about/build_system.md` (from `integrate/about/build_system.md`)

### 3.2 Update README.md
**Priority**: Medium
**Risk**: Medium

**Actions**:
1. Update project structure section to reflect new scripts
2. Update build instructions to reference new build system
3. Add documentation about new version management system
4. Update examples to use new `scripts/build.sh`

**Key sections to update**:
- Project File Structure (lines 470-489)
- Build instructions
- Add reference to new build system documentation

## Phase 4: Environment Configuration

### 4.1 Copy .env.example
**Priority**: High
**Risk**: Low

**Action**: Copy `.env.example` from integrate/ to root directory

### 4.2 Update init_plugin_project.sh References
**Priority**: High
**Risk**: Low

**Action**: Ensure the updated init_plugin_project.sh properly references the new .env.example structure

## Phase 5: Integration Validation

### 5.1 File Structure Validation
**Checklist**:
- [ ] All files from integrate/ are in correct locations
- [ ] All scripts are executable
- [ ] No broken file references
- [ ] integrate/ folder can be removed

### 5.2 Functional Validation
**Tests to perform**:
1. **Basic Setup Test**:
   ```bash
   cp .env.example .env
   # Edit .env with test values
   ./init_plugin_project.sh
   ```

2. **Build System Test**:
   ```bash
   ./generate_and_open_xcode.sh
   ./scripts/build.sh standalone
   ```

3. **Version Management Test**:
   ```bash
   python3 scripts/bump_version.py --dry-run
   python3 scripts/bump_version.py --export-only
   ```

4. **Validation Tools Test**:
   ```bash
   ./scripts/validate_plugin.sh
   ./scripts/diagnose_plugin.sh
   ```

### 5.3 Documentation Validation
**Tests**:
- [ ] README.md accurately reflects new structure
- [ ] CLAUDE.md provides correct build instructions
- [ ] build_system.md is accessible and complete

## Phase 6: Cleanup

### 6.1 Remove Integration Artifacts
**Actions**:
- Remove `integrate/` folder and all contents
- Remove this plan file (optional)

### 6.2 Final Repository State
**Expected structure**:
```
JUCE-Plugin-Starter/
├── .env.example                   ← ADDED: Comprehensive environment template
├── CLAUDE.md                      ← UPDATED: New build process instructions
├── CMakeLists.txt                 ← UPDATED: Enhanced build configuration
├── dependencies.sh                ← UNCHANGED
├── generate_and_open_xcode.sh     ← UPDATED: Version management integration
├── init_plugin_project.sh         ← UPDATED: Enhanced project initialization
├── README.md                      ← UPDATED: New build system documentation
├── scripts/                       ← ENHANCED: Additional tooling
│   ├── about/                     ← NEW: Documentation folder
│   │   └── build_system.md        ← NEW: Comprehensive build system docs
│   ├── build.sh                   ← NEW: Unified build system
│   ├── bump_version.py            ← NEW: Semantic version management
│   ├── diagnose_plugin.sh         ← NEW: Plugin diagnostic tool
│   ├── generate_release_notes.py  ← NEW: AI-powered release notes
│   ├── post_build.sh              ← UPDATED: Enhanced version handling

│   └── validate_plugin.sh         ← NEW: Plugin validation tool
├── Source/                        ← UNCHANGED
└── installer/                     ← UNCHANGED
```

## Risk Assessment

### High Risk Items
- CMakeLists.txt replacement (could break existing projects)
- generate_and_open_xcode.sh replacement (core build functionality)

### Medium Risk Items
- init_plugin_project.sh replacement (project setup process)
- scripts/post_build.sh replacement (version management changes)

### Low Risk Items
- New script additions (additive changes)
- Documentation updates
- .env.example creation

## Rollback Plan

If integration fails:
1. Restore original files from git history
2. Remove any new files that were added
3. Restore original directory structure
4. Document specific failure points for future attempts

## Success Criteria

Integration is successful when:
1. ✅ All files are in correct locations
2. ✅ `./init_plugin_project.sh` completes successfully
3. ✅ `./generate_and_open_xcode.sh` generates project without errors
4. ✅ `./scripts/build.sh standalone` builds and launches app
5. ✅ Version management works: `python3 scripts/bump_version.py`
6. ✅ All new tools are functional
7. ✅ Documentation is accurate and complete
8. ✅ No broken references or missing dependencies

---

**Next Steps**: Review this plan and confirm approach before proceeding with implementation.
